---
- name: Prepare for vault role
  gather_facts: true
  hosts: consul
  vars:
    consul_bind_interface: lo
    consul_bind_ip: 127.0.0.1
    consul_vip_address: 127.0.0.1
    vault_bind_address: 127.0.0.1
    vault_api_addr: http://127.0.0.1:8200
    vault_config_dir: "/etc/vault"
    vault_root_ca_name: "ROOT_CA"
    vault_intermediate_ca_name: "INT_CA"
    copy_self_signed_ca: false

  pre_tasks:
    - name: Ensure /etc/vault exists
      file:
        path: /etc/vault
        state: directory
      become: true

  roles:
    - role: stackhpc.hashicorp.vault
    - role: stackhpc.hashicorp.vault_backend



